Oskari Saarenmaa: initial implementation.

Roland Karch: compatibility with version 18.2+ databases.
